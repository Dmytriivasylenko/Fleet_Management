{% extends 'base.html' %}
{% load static %}

{% block content %}
<h2>Service History</h2>

<!-- ðŸ”¥ Ð¤Ñ–Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð°Ð²Ñ‚Ð¾ -->
<div class="top-controls" style="margin-bottom: 20px;">

    <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ð´Ð»Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð°Ð²Ñ‚Ð¾ -->
    <button class="btn"
            hx-get="{% url 'vehicle_form_modal' %}"
            hx-target="body"
            hx-swap="beforeend">
        Add New Vehicle
    </button>

    <!-- Ð¤Ñ–Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð°Ð²Ñ‚Ð¾ -->
    <select id="serviceFilter"
            hx-get="{% url 'service_history_filter' %}"
            hx-target="#serviceTableBody"
            hx-trigger="change"
            name="vehicle"
            class="filter-select"
            style="margin-left: 20px;">

        <option value="">All Vehicles</option>

        {% for v in vehicles %}
            <option value="{{ v.id }}">{{ v.make }} {{ v.model }} ({{ v.year }})</option>
        {% endfor %}
    </select>
</div>

<!-- Ð¤Ð¾Ñ€Ð¼Ð° Ð´Ð¾Ð´Ð°Ð²Ð°Ð½Ð½Ñ ÑÐµÑ€Ð²Ñ–ÑÑƒ -->
<form hx-post="{% url 'add_service_htmx' %}"
      hx-target="#serviceTableBody"
      hx-swap="beforeend"
      style="margin-bottom: 20px;">

    {% csrf_token %}

    <select name="vehicle" id="vehicleSelect" required>
        {% for vehicle in vehicles %}
            <option value="{{ vehicle.id }}">{{ vehicle.make }} {{ vehicle.model }} ({{ vehicle.year }})</option>
        {% endfor %}
    </select>

    <input type="text" name="service_type" placeholder="Service Type" required>
    <input type="number" step="0.01" name="cost" placeholder="Cost" required>
    <input type="date" name="next_service_date" required>
    <input type="date" name="service_date" required>
    <input type="number" name="odometer_at_service" placeholder="Odometer" required>

    <textarea name="notes" placeholder="Notes"></textarea>

    <button type="submit" class="btn">Add Service</button>
</form>

<!-- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ ÑÐµÑ€Ð²Ñ–ÑÑ–Ð² -->
<table id="serviceTable" border="1" width="100%">
    <thead>
        <tr>
            <th>Vehicle</th>
            <th>Service Type</th>
            <th>Cost</th>
            <th>Next Service</th>
            <th>Notes</th>
        </tr>
    </thead>

    <!-- ðŸ”¥ Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ð¼Ð¾ partial -->
    <tbody id="serviceTableBody">
        {% include "partials/service/partials/services_table_body.html" %}
    </tbody>
</table>

{% endblock %}
